# Tab Suspender

> 自動暫停閒置標籤以節省記憶體 - 白名單、自訂時間、智慧偵測

[![Manifest V3](https://img.shields.io/badge/Manifest-V3-blue.svg)](https://developer.chrome.com/docs/extensions/mv3/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

---

## 功能特色

- **自動暫停**: 閒置標籤自動暫停，釋放記憶體資源
- **自訂時間**: 設定閒置多久後暫停（5分鐘至4小時）
- **白名單**: 指定永不暫停的網站
- **智慧偵測**: 自動跳過播放音訊、表單輸入中的標籤
- **一鍵操作**: 快速暫停其他標籤或恢復全部
- **記憶體統計**: 即時顯示節省的記憶體量
- **鍵盤快捷鍵**: 支援快捷鍵快速操作

---

## 安裝方式

### 開發者模式安裝

1. 下載此資料夾
2. 開啟 Chrome，前往 `chrome://extensions/`
3. 開啟右上角「開發人員模式」
4. 點擊「載入未封裝項目」
5. 選擇此擴充功能資料夾

---

## 使用方式

### 自動暫停
啟用後，擴充功能會自動監控標籤閒置時間：
- 超過設定時間的閒置標籤會自動暫停
- 暫停的標籤會顯示「已暫停」標記
- 點擊暫停的標籤會自動恢復

### 手動操作
- **暫停當前標籤**: 使用快捷鍵 `Alt+S`
- **暫停其他標籤**: 點擊「暫停其他標籤」按鈕或使用 `Alt+Shift+S`
- **恢復全部**: 點擊「恢復全部」按鈕

### 白名單管理
1. 切換到「白名單」標籤頁
2. 輸入網域名稱（如 `google.com`）
3. 點擊「+」按鈕新增
4. 或在標籤列表中點擊「✓」圖示快速加入

### 智慧偵測
以下標籤不會被自動暫停：
- 當前活動的標籤
- 釘選的標籤（可在設定中關閉）
- 播放音訊的標籤（可在設定中關閉）
- 白名單中的網站
- Chrome 內部頁面

---

## 鍵盤快捷鍵

| 快捷鍵 | 功能 |
|--------|------|
| `Alt+S` | 暫停當前標籤 |
| `Alt+Shift+S` | 暫停其他標籤 |

---

## 設定選項

| 選項 | 說明 | 預設值 |
|------|------|--------|
| 閒置暫停時間 | 標籤閒置多久後自動暫停 | 30 分鐘 |
| 暫停釘選標籤 | 是否暫停釘選的標籤 | 否 |
| 暫停音訊標籤 | 是否暫停播放音訊的標籤 | 否 |
| 顯示通知 | 暫停標籤時顯示通知 | 否 |
| 忽略表單輸入 | 跳過有表單輸入的標籤 | 是 |

---

## 權限說明

| 權限 | 用途 | 風險程度 |
|------|------|----------|
| `tabs` | 讀取標籤資訊、暫停/恢復標籤 | 中 |
| `storage` | 儲存設定與白名單 | 極低 |
| `alarms` | 定時檢查閒置標籤 | 極低 |
| `idle` | 偵測使用者閒置狀態 | 低 |

### 隱私聲明
- 所有資料僅儲存在本地
- 不會傳送任何資料到外部伺服器
- 不收集任何使用者資訊

---

## 技術規格

| 項目 | 內容 |
|------|------|
| Manifest 版本 | V3 |
| 最低 Chrome 版本 | 116 |
| 程式語言 | JavaScript (ES6+) |
| UI 框架 | Vanilla JS |
| 儲存方式 | Chrome Storage API |

### 使用的 Chrome API
- `chrome.tabs` - 標籤管理（discard、reload）
- `chrome.tabs.discard()` - 核心暫停功能
- `chrome.storage` - 本地儲存
- `chrome.alarms` - 定時檢查
- `chrome.idle` - 閒置偵測
- `chrome.runtime` - 訊息傳遞
- `chrome.commands` - 鍵盤快捷鍵

---

## 檔案結構

```
003-tab-suspender/
├── manifest.json      # 擴充功能配置
├── background.js      # Service Worker
├── popup.html         # Popup 介面
├── popup.css          # Popup 樣式
├── popup.js           # Popup 邏輯
├── icons/
│   ├── icon16.png     # 16x16 圖示
│   ├── icon48.png     # 48x48 圖示
│   └── icon128.png    # 128x128 圖示
└── README.md          # 說明文件
```

---

## 工作原理

### 標籤暫停機制
Tab Suspender 使用 Chrome 內建的 `chrome.tabs.discard()` API：
- 將標籤從記憶體中卸載
- 保留標籤在標籤列的位置
- 點擊時自動重新載入
- 不會遺失歷史記錄

### 閒置追蹤
- Service Worker 追蹤每個標籤的最後活動時間
- 每分鐘檢查一次所有標籤
- 超過閾值的標籤自動暫停

### 記憶體估算
- 每個暫停的標籤約節省 50MB 記憶體
- 實際節省量視網頁複雜度而異

---

## 常見問題

### Q: 暫停的標籤會遺失資料嗎？
A: 不會。暫停使用 Chrome 內建的 discard 功能，只是將標籤從記憶體卸載。點擊時會重新載入，但未儲存的表單資料可能會遺失。

### Q: 為什麼某些標籤無法暫停？
A: 以下標籤無法暫停：
- Chrome 內部頁面（chrome://）
- 擴充功能頁面
- 正在播放音訊的標籤（如未在設定中允許）
- 白名單中的網站

### Q: 如何完全停用自動暫停？
A: 點擊擴充功能圖示，關閉右上角的開關即可。

---

## 更新日誌

### v1.0.0 (2024-12-01)
- 初始版本發布
- 自動暫停閒置標籤
- 白名單管理
- 可自訂暫停時間
- 鍵盤快捷鍵支援
- 記憶體統計顯示
- 深色模式支援

---

## 授權

MIT License - 詳見專案根目錄 LICENSE 文件
