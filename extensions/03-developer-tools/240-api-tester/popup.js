// API Tester - Popup Script
class ApiTester {
  constructor() { this.initElements(); this.bindEvents(); }
  initElements() { this.methodEl = document.getElementById('method'); this.urlEl = document.getElementById('url'); this.headersEl = document.getElementById('headers'); this.bodyEl = document.getElementById('body'); this.responseEl = document.getElementById('response'); this.statusEl = document.getElementById('status'); this.sendBtn = document.getElementById('sendBtn'); }
  bindEvents() { this.sendBtn.addEventListener('click', () => this.send()); }
  async send() { const url = this.urlEl.value.trim(); if (!url) { this.responseEl.value = 'Please enter a URL'; return; } const method = this.methodEl.value; let headers = {}; let body = undefined; try { if (this.headersEl.value.trim()) headers = JSON.parse(this.headersEl.value); } catch { this.responseEl.value = 'Invalid headers JSON'; return; } if (['POST', 'PUT', 'PATCH'].includes(method) && this.bodyEl.value.trim()) { try { body = this.bodyEl.value.trim(); JSON.parse(body); } catch { this.responseEl.value = 'Invalid body JSON'; return; } } this.sendBtn.textContent = 'Sending...'; this.sendBtn.disabled = true; try { const start = Date.now(); const res = await fetch(url, { method, headers, body }); const elapsed = Date.now() - start; const text = await res.text(); let formatted; try { formatted = JSON.stringify(JSON.parse(text), null, 2); } catch { formatted = text; } this.statusEl.textContent = `${res.status} ${res.statusText} (${elapsed}ms)`; this.statusEl.className = res.ok ? 'success' : 'error'; this.responseEl.value = formatted; } catch (e) { this.statusEl.textContent = 'Error'; this.statusEl.className = 'error'; this.responseEl.value = e.message; } this.sendBtn.textContent = 'Send Request'; this.sendBtn.disabled = false; }
}
document.addEventListener('DOMContentLoaded', () => new ApiTester());
